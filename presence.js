'use strict';

import RPC from 'discord-rpc';
import fs from 'fs';

const client = new RPC.Client({ transport: 'ipc' })

const rawdata = fs.readFileSync('options.json');
const options = JSON.parse(rawdata);

//console.log(options);

let activity = {};
let assets = {};

if (options['largeimage'] !== "") {
	assets.large_image = options['largeimage'];
	assets.large_text = "Made with ThatOneCalculator's Discord RPC Generator!";
}
if (options['smallimage'] !== "") {
	assets.small_image = options['smallimage'];
	assets.small_text = "https://github.com/ThatOneCalculator/DiscordRPCGenerator"
}
if (assets !== {}) { activity.assets = assets; }
if (options['description'] !== "") { activity.details = options['description']; }
if (options['state'] !== "") { activity.state = options['state']; }
if (options['buttons'].length !== 0) { activity.buttons = options['buttons']; }

client.on('ready', () => {
    client.request('SET_ACTIVITY', {
        pid: process.pid,
        activity: activity
      })
    console.log('Your Rich Presence has started! Generated by https://github.com/ThatOneCalculator/DiscordRPCGenerator.')
})

client.login({clientId: options['clientid']})
